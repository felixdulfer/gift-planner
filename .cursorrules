# Gift Planner - Cursor Rules

## Tech Stack
- **Package Manager**: Bun
- **Framework**: TanStack Start (React 19)
- **Routing**: TanStack Router (file-based routing)
- **State Management**: TanStack Store
- **Data Fetching**: TanStack Query
- **Styling**: Tailwind CSS v4
- **UI Components**: Shadcn UI (Radix UI primitives)
- **Linting/Formatting**: Biome
- **Testing**: Vitest
- **Build Tool**: Vite
- **TypeScript**: Strict mode enabled

## Code Style

### Formatting
- Use Biome for all formatting (configured in biome.json)
- Use tabs for indentation
- Use double quotes for strings
- Organize imports automatically on save
- Follow Biome's recommended linting rules

### TypeScript
- Use strict TypeScript mode
- Prefer explicit types over `any`
- Use type inference where appropriate
- Follow the `@/*` path alias pattern (configured in tsconfig.json)
- No unused locals or parameters

### React
- Use functional components with hooks
- Prefer named exports for components
- Use React 19 features (React Compiler enabled)
- Keep components focused and single-purpose
- Use TypeScript for component props

## File Organization

### Routes
- Routes are file-based in `src/routes/`
- Use TanStack Router conventions:
  - `__root.tsx` for the root layout
  - `$param.tsx` for dynamic route parameters
  - `index.tsx` for index routes
- Route files should export a `Route` constant created with `createRoute()`

### Components
- Place reusable components in `src/components/ui/` (Shadcn components)
- Place feature-specific components in `src/components/`
- Use PascalCase for component files
- Co-locate component styles with components (Tailwind classes)

### Utilities
- Place utility functions in `src/lib/` or `src/utils/`
- Use kebab-case for utility files
- Export utilities as named exports

### Data & Hooks
- Place data files in `src/data/`
- Place custom hooks in `src/hooks/`
- Use the `use` prefix for custom hooks

## Component Patterns

### Shadcn UI Components
Use the latest version of Shadcn to install new components:
```bash
pnpx shadcn@latest add button
```

- Always use Shadcn components from `src/components/ui/`
- Extend Shadcn components rather than creating from scratch
- Follow Shadcn's component patterns and API

### TanStack Router
- Use `createRoute()` for route definitions
- Use `loader` for data loading before render
- Use `useLoaderData()` to access loader data
- Use `Link` component for navigation
- Use `Outlet` for nested routes in layouts

### TanStack Query
- Use `useQuery` for data fetching
- Use `useMutation` for mutations
- Provide proper query keys
- Handle loading and error states

### TanStack Store
- Create stores with `new Store()`
- Use `useStore()` hook to access store state
- Use `Derived` stores for computed state
- Mount derived stores with `.mount()`

## Styling

### Tailwind CSS
- Use Tailwind utility classes
- Prefer Tailwind classes over custom CSS
- Use Tailwind v4 conventions
- Use `cn()` utility from `src/lib/utils.ts` for conditional classes

### CSS Files
- Avoid creating custom CSS files unless necessary
- Use `src/styles.css` for global styles
- Prefer Tailwind's `@apply` directive for component styles if needed

## Testing

### Vitest
- Write tests for critical functionality
- Use Testing Library for React component tests
- Place test files next to source files with `.test.ts` or `.test.tsx` extension
- Follow Testing Library best practices

## Git & Version Control

### Commits
- Write clear, descriptive commit messages
- Use conventional commit format when appropriate
- Keep commits focused and atomic

### Worktrees
- This project is configured for git worktrees
- Use worktrees for feature branches when needed
- Cursor is configured to detect worktrees automatically

## Code Generation

### Route Tree
- `src/routeTree.gen.ts` is auto-generated by TanStack Router
- Never edit this file manually
- It's excluded from formatting and linting

## Best Practices

1. **Type Safety**: Always use TypeScript types, avoid `any`
2. **Performance**: Use React.memo, useMemo, useCallback when appropriate
3. **Accessibility**: Ensure components are accessible (Shadcn components handle this)
4. **Error Handling**: Always handle errors in async operations
5. **Loading States**: Provide loading states for async operations
6. **Code Organization**: Keep files focused and maintainable
7. **Naming**: Use descriptive, clear names for variables, functions, and components
8. **Comments**: Write comments for complex logic, not obvious code

## Demo Files
- Files prefixed with `demo` can be safely deleted
- They are examples and starting points for learning the stack

## Environment Variables
- Use `.env` files for environment variables
- Never commit sensitive keys to git
- Document required env vars in README

## When Adding New Features

1. Create route files in `src/routes/` following TanStack Router conventions
2. Use Shadcn components for UI elements
3. Use TanStack Query for data fetching
4. Use TanStack Store for client-side state
5. Write tests for critical paths
6. Follow the existing code patterns and structure
7. Run `bun run check` before committing
